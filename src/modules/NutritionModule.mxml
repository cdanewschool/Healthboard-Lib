<?xml version="1.0" encoding="utf-8"?>
<s:VGroup 
	xmlns:fx="http://ns.adobe.com/mxml/2009" 
	xmlns:s="library://ns.adobe.com/flex/spark" 
	xmlns:mx="library://ns.adobe.com/flex/mx" 
	xmlns:components="components.*" 
	xmlns:plus="external.TabBarPlus.plus.*"
	xmlns:general="components.general.*"
	initialize="updateNutritionDatesMonth('thisMonth');" 
	creationComplete="init();" >
	
	<fx:Script>
		<![CDATA[
			import mx.collections.Sort;
			import mx.events.DataGridEvent;
		]]>
	</fx:Script>
	
	<fx:Declarations>
		<!-- Place non-visual elements (e.g., services, value objects) here -->
		<fx:Array id="bge">
			<mx:GridLines gridDirection="vertical" alpha=".7" />
		</fx:Array>
	</fx:Declarations>

	<s:states>
		<s:State name="default" />
		<s:State name="provider" />
	</s:states>
	
	<fx:Script>
		<![CDATA[
			import models.UserModel;
			import spark.components.TitleWindow;
			import mx.graphics.LinearGradient;
			import mx.graphics.GradientEntry;
			import mx.collections.SortField;
			import ASclasses.Constants;
			
			import components.popups.nutrition.downloadWorksheetWindow;
			import components.popups.nutrition.help;
			import components.popups.nutrition.tips;
			import components.tooltips.nutrition.FoodJournalToolTip;
			import components.tooltips.nutrition.FoodPlanToolTip;
			
			import controllers.NutritionController;
			
			import enum.DateRanges;
			
			import events.ApplicationEvent;
			
			import models.modules.NutritionModel;
			
			import mx.charts.ChartItem;
			import mx.events.ListEvent;
			import mx.events.ToolTipEvent;
			import mx.graphics.IFill;
			import mx.graphics.SolidColor;
			import mx.managers.PopUpManager;
			
			import styles.ChartStyles;
			
			import util.DateUtil;
			
			[Bindable] [Embed("/images/vitalSignsCommentPatient.png")] public var iconComment:Class;
			
			[Bindable] [Embed("/images/nutritionPlateEmpty.png")] public var plateEmpty:Class;
			[Bindable] [Embed("/images/nutritionPlateFull.png")] public var plateFull:Class;
			[Bindable] [Embed("/images/nutritionPlateAlmostFull.png")] public var plateAlmostFull:Class;
			[Bindable] [Embed("/images/nutritionPlatePartial.png")] public var platePartial:Class;
			[Bindable] [Embed("/images/nutritionPlateAlternative.png")] public var plateAlternative:Class;
			[Bindable] [Embed('/images/nutritionFoodJournalEmpty.png')] public var bigPlateEmpty:Class;
			[Bindable] [Embed('/images/nutritionFoodJournal.png')] public var bigPlatePartial:Class;
			[Bindable] [Embed('/images/nutritionFoodJournalFull.png')] public var bigPlateFull:Class;
			[Bindable] [Embed('/images/nutritionFoodJournalAlmostFull.png')] public var bigPlateAlmostFull:Class;
			[Bindable] [Embed("/images/nutritionBigSodiumEmpty.png")] public var bigSodiumEmpty:Class;
			[Bindable] [Embed("/images/nutritionBigSodiumPartial.png")] public var bigSodiumPartial:Class;
			[Bindable] [Embed("/images/nutritionBigSodiumFull.png")] public var bigSodiumFull:Class;
			[Bindable] [Embed("/images/nutritionBigSodiumFullRed.png")] public var bigSodiumFullRed:Class;
			[Bindable] [Embed("/images/nutritionBigFatsOilsEmpty.png")] public var bigFatsOilsEmpty:Class;
			[Bindable] [Embed("/images/nutritionBigFatsOilsPartial.png")] public var bigFatsOilsPartial:Class;
			[Bindable] [Embed("/images/nutritionBigFatsOilsFull.png")] public var bigFatsOilsFull:Class;
			[Bindable] [Embed("/images/nutritionBigAlcoholEmpty.png")] public var bigAlcoholEmpty:Class;
			[Bindable] [Embed("/images/nutritionBigAlcoholPartial.png")] public var bigAlcoholPartial:Class;
			[Bindable] [Embed("/images/nutritionBigAlcoholFull.png")] public var bigAlcoholFull:Class;
			[Bindable] [Embed("/images/nutritionBigWaterEmpty.png")] public var bigWaterEmpty:Class;
			[Bindable] [Embed("/images/nutritionBigWaterPartial.png")] public var bigWaterPartial:Class;
			[Bindable] [Embed("/images/nutritionBigWaterFull.png")] public var bigWaterFull:Class;
			[Bindable] [Embed("/images/nutritionBigWaterVeryFull.png")] public var bigWaterVeryFull:Class;
			[Bindable] [Embed('/images/nutritionGauge0.png')] public var gaugeEmpty:Class;
			[Bindable] [Embed('/images/nutritionGauge1.png')] public var gaugePartial:Class;
			[Bindable] [Embed('/images/nutritionGauge2.png')] public var gaugeFull:Class;
			[Bindable] [Embed('/images/nutritionGauge3.png')] public var gaugeAlmostFull:Class;
			[Bindable] [Embed('/images/nutritionNewChartSodium0.png')] public var newChartSodium0:Class;
			[Bindable] [Embed('/images/nutritionNewChartSodium1.png')] public var newChartSodium1:Class;
			[Bindable] [Embed('/images/nutritionNewChartSodium2.png')] public var newChartSodium2:Class;
			[Bindable] [Embed('/images/nutritionNewChartFatsOils0.png')] public var newChartFatsOils0:Class;
			[Bindable] [Embed('/images/nutritionNewChartFatsOils1.png')] public var newChartFatsOils1:Class;
			[Bindable] [Embed('/images/nutritionNewChartFatsOils2.png')] public var newChartFatsOils2:Class;
			[Bindable] [Embed('/images/nutritionNewChartSugar0.png')] public var newChartSugar0:Class;
			[Bindable] [Embed('/images/nutritionNewChartSugar1.png')] public var newChartSugar1:Class;
			[Bindable] [Embed('/images/nutritionNewChartSugar2.png')] public var newChartSugar2:Class;
			[Bindable] [Embed('/images/nutritionNewChartAlcohol0.png')] public var newChartAlcohol0:Class;
			[Bindable] [Embed('/images/nutritionNewChartAlcohol1.png')] public var newChartAlcohol1:Class;
			[Bindable] [Embed('/images/nutritionNewChartAlcohol2.png')] public var newChartAlcohol2:Class;
			
			[Bindable] private var controller:NutritionController = AppProperties.getInstance().controller.nutritionController as NutritionController;
			[Bindable] public var model:NutritionModel = controller.model as NutritionModel;
			[Bindable] private var chartStyles:ChartStyles = AppProperties.getInstance().controller.model.chartStyles;
			
			[Bindable] private var nutCaloriesXaxisMaximumToday:int = 500;
			[Bindable] private var nutCaloriesXaxisMaximumCurrent:int = 500;
			
			[Bindable] public var showHeader:Boolean = true;
			
			[Bindable] private var currentDayDiff:int = 0;
			[Bindable] private var currentWeekDiff:int = 0;
			[Bindable] private var currentMonthDiff:int = 0;
			
			[Bindable] private var currentDailyPlate:uint = 0;
			[Bindable] private var currentWeeklyPlate:uint = 1;
			[Bindable] private var currentMonthlyPlate:uint = 2;
			[Bindable] private var currentMonth:Date;
			
			private var today:Date = AppProperties.getInstance().controller.model.today;
			private var thisSunday:Date = new Date(today.getTime() - today.getDay() * DateUtil.DAY);
			private var thisSaturday:Date = new Date(thisSunday.getTime() + 6 * DateUtil.DAY);
			
 			private var _glassesTaken:uint = 0;
			
			[Bindable] private var arrMonthlyCalories1:Array = new Array(1900,1970,2000,1900,2150,1800,2000,1900,2050,1750,2000,1900,1750,1800,2100,2000,1900,2000,1800,1800,1900,2150,1600,1900,1700,2000,1650,1800,2200,475);
			private var arrMonthlyCalories2:Array = new Array(2000,1800,1900,1600,1700,1700,2100,1800,1900,2000,2000,2050,1750,1900,2100,2150,2000,2100,1800,1600,1800,1900,2000,1900,2150,1800,1600,2000,2150,1900);
			private var arrMonthlyCalories3:Array = new Array(1900,2000,1650,1750,1900,2150,2050,2000,2150,1950,2100,2000,1800,1850,1800,1900,1600,1650,1600,1750,1800,1750,1600,1700,1900,2000,2000,2000,2100,1900);
			
			[Bindable] public var nutritionRollOverRowIndex:int = -2;
			
			[Bindable] public var mealTypes:Array = new Array('Breakfast','Lunch','Snack','Dinner');
			
			public var patient:UserModel;
			
			[Bindable]
			public function get glassesTaken():uint
			{
				return _glassesTaken;
			}
			
			public function set glassesTaken(value:uint):void
			{
				var dirty:Boolean = _glassesTaken != value;
				
				_glassesTaken = value;
				
				if( dirty )
				{
					var event:ApplicationEvent = new ApplicationEvent( ApplicationEvent.SHOW_STATUS, true );
					event.data = "Your water intake has been recorded";
					dispatchEvent( event );
				}
			}

			private function onNutritionRollOver(event:ListEvent):void
			{
				nutritionRollOverRowIndex = event.rowIndex;
			}
			
			private function setState( state:String ):void
			{
				var event:ApplicationEvent = new ApplicationEvent( ApplicationEvent.SET_STATE, true );
				event.data = state;
				dispatchEvent( event );
			}
			
			private function showNutritionHelp():void 
			{
				var myHelpWindow:help = help(PopUpManager.createPopUp(AppProperties.getInstance().controller.application, help) as spark.components.TitleWindow);
				myHelpWindow.viewStackHelp.selectedIndex = 3;
				
				PopUpManager.centerPopUp(myHelpWindow);
			}
			
			private function handleNutritionMealEntry():void 
			{
				model.hasMealBeenSubmitted = true;
				
				if(dropDownNutritionMealType.selectedIndex == 1 || dropDownNutritionMealType.selectedIndex == 3) 
				{
					model.mealType = 'full';
					
					model.summaryCalories.getItemAt(0).calories = 1700;
					model.summaryCalories.getItemAt(0).caloriesFromExtras = 515;
					model.summaryCalories.getItemAt(0).extrasFats = 165;
					model.summaryCalories.getItemAt(0).extrasSugar = 150;
					model.summaryCalories.getItemAt(0).extrasAlcohol = 200;
				}
				else 
				{
					model.mealType = 'partial';
					
					model.summaryCalories.getItemAt(0).calories = 532;
					model.summaryCalories.getItemAt(0).caloriesFromExtras = 230;
					model.summaryCalories.getItemAt(0).extrasFats = 150;
					model.summaryCalories.getItemAt(0).extrasSugar = 80;
					model.summaryCalories.getItemAt(0).extrasAlcohol = 0;
				}
				
				model.summaryCalories.refresh();
				model.dailyCaloriesCurrent.refresh();
				
				if( nutComments.text != 'Enter when, where, and why you had the meal.' 
					&& nutComments.text != '') 
					btnNutReadComment.visible = true;
				
				var portionUnit:String = nutritionPortionTypes.selectedItem;
				
				if( portionUnit == 'other' )
				{
					portionUnit = nutritionPortionOther.text;
				}
				
				var now:Date = new Date();
				model.foodJournal.addItem( { meal:dropDownNutritionMealType.selectedItem, portion: numPortion.value + ' ' + portionUnit, ingredients:(nutritionFoodSearch.text != 'Search' && nutritionFoodSearch.text != '') ? nutritionFoodSearch.text : dropDownNutritionSavedMeal.selectedItem, calories:123, date:DateUtil.get10DigitDate((now.getMonth()+1)+'/'+now.getDate()+'/'+now.getFullYear()), comments:(nutComments.text == 'Enter when, where, and why you had the meal.') ? '' : nutComments.text});
				
				nutritionJournal.rowCount++;
				nutritionJournal.rowCount--;		//this is a quick trick to get nutritionJournal.rowCount to refresh
				
				var event:ApplicationEvent = new ApplicationEvent( ApplicationEvent.SHOW_STATUS, true );
				event.data = "Your meal has been recorded";
				dispatchEvent( event );
				
				clearForm();
			}
			
			private function clearForm():void
			{
				dropDownNutritionMealType.selectedIndex = 0;
				dropDownNutritionSavedMeal.selectedIndex = -1;
				
				nutritionFoodSearch.text = "Search";
				numPortion.value = 1;
				nutritionPortionTypes.selectedIndex = 0;
				
				nutComments.text = "Enter when, where, and why you had the meal.";
			}
			
			private function avg(values:Array):int 
			{
				var sum:int = 0;
				for(var i:uint = 0; i < values.length; i++) 
				{
					sum += values[i];
				}
				return Math.round(sum/values.length);
			}
			
			private function setDateRange(range:String=null):void
			{
				model.dateRange = range;
				
				updateDateRange();
			}
			
			private function updateDateRange():void 
			{
				var meal:Object;
				
				if( model.dateRange == DateRanges.DAY ) 
				{
					viewsNutritionJournal.selectedIndex = 0;
					
					showJournalPlate(currentDailyPlate);
					showCurrentDay();
					
					nutritionJournal.dataProvider = (currentDayDiff == 0) ? model.foodJournal : (currentDailyPlate == 1) ? model.foodJournalAlt2 : model.foodJournalAlt1;
					
					for each(meal in nutritionJournal.dataProvider) 
					{
						meal.date = DateUtil.get10DigitDate((currentDay.getMonth()+1)+'/'+currentDay.getDate()+'/'+currentDay.getFullYear())
					}
				}
				else if( model.dateRange == DateRanges.WEEK ) 
				{
					viewsNutritionJournal.selectedIndex = 1;
					
					showJournalPlate(currentWeeklyPlate);
					showCurrentWeek();
					
					nutritionJournal.dataProvider = (currentWeekDiff == 0) ? model.foodJournal : (currentWeeklyPlate == 1) ? model.foodJournalAlt2 : model.foodJournalAlt1;
					
					for each(meal in nutritionJournal.dataProvider) 
					{
						meal.date = DateUtil.get10DigitDate((currentSunday.getMonth()+1)+'/'+currentSunday.getDate()+'/'+currentSunday.getFullYear())
					}
				}
				else if( model.dateRange == DateRanges.MONTH ) 
				{
					viewsNutritionJournal.selectedIndex = 2;
					
					showJournalPlate(currentMonthlyPlate);
					showCurrentMonth();
					
					nutritionJournal.dataProvider = (currentMonthDiff == 0) ? model.foodJournal : (currentMonthlyPlate == 1) ? model.foodJournalAlt2 : model.foodJournalAlt1;
					
					for each(meal in nutritionJournal.dataProvider) 
					{
						meal.date = DateUtil.get10DigitDate((currentMonth.getMonth()+1)+'/01/'+currentMonth.getFullYear())
					}
				}
			}
			
			private function showJournalPlate(plate:uint):void
			{
				//	today's intake
				if(plate == 0) 
				{
					imgNutJournalMyPlate.source = !model.hasMealBeenSubmitted ? plateEmpty : model.mealType == 'full' ? plateFull : platePartial;		//imgNutJournalMyPlate.source = !model.hasMealBeenSubmitted ? bigPlateEmpty : model.mealType == 'full' ? bigPlateFull : bigPlatePartial;
					imgSodiumChart.source = !model.hasMealBeenSubmitted ? newChartSodium0 : model.mealType == 'full' ? newChartSodium2 : newChartSodium1;
					imgFatsOilsChart.source = !model.hasMealBeenSubmitted ? newChartFatsOils0 : model.mealType == 'full' ? newChartFatsOils2 : newChartFatsOils1;
					imgSugarChart.source = !model.hasMealBeenSubmitted ? newChartSugar0 : model.mealType == 'full' ? newChartSugar2 : newChartSugar1;
					imgAlcoholChart.source = !model.hasMealBeenSubmitted ? newChartAlcohol0 : model.mealType == 'full' ? newChartAlcohol2 : newChartAlcohol0;
				}
				
				//	alternative intake 1
				else if(plate == 1)
				{
					imgNutJournalMyPlate.source = plateAlmostFull;		//imgNutJournalMyPlate.source = bigPlateAlmostFull;
					imgSodiumChart.source = newChartSodium1;
					imgFatsOilsChart.source = newChartFatsOils1;
					imgSugarChart.source = newChartSugar1;
					imgAlcoholChart.source = newChartAlcohol1;
				}
				
				//	alternative intake 2
				else 
				{
					imgNutJournalMyPlate.source = plateFull;			//imgNutJournalMyPlate.source = bigPlateFull;
					imgSodiumChart.source = newChartSodium2;
					imgFatsOilsChart.source = newChartFatsOils2;
					imgSugarChart.source = newChartSugar2;
					imgAlcoholChart.source = newChartAlcohol2;
				}
			}
			
			private var currentDay:Date;
			private var currentSunday:Date;
			private var currentSaturday:Date;
			
			private function showCurrentDay():void 
			{
				currentDay = new Date( today.getTime() + currentDayDiff * DateUtil.DAY );
				nutJournalDate.text = DateUtil.formatDateFromString((currentDay.getMonth()+1)+'/'+currentDay.getDate()+'/'+currentDay.getFullYear());
			}
			
			private function showCurrentWeek():void 
			{
				currentSunday = new Date( thisSunday.getTime() + currentWeekDiff * DateUtil.WEEK );
				currentSaturday = new Date( thisSaturday.getTime() + currentWeekDiff * DateUtil.WEEK );
				nutJournalDate.text = DateUtil.formatDateFromString((currentSunday.getMonth()+1)+'/'+currentSunday.getDate()+'/'+currentSunday.getFullYear()) + ' - ' + DateUtil.formatDateFromString((currentSaturday.getMonth()+1)+'/'+currentSaturday.getDate()+'/'+currentSaturday.getFullYear());
			}
			
			private function showCurrentMonth():void 
			{
				currentMonth = new Date( today.getTime() + currentMonthDiff * ((365.2425/12)*DateUtil.DAY) );
				nutJournalDate.text = Constants.MONTHS[currentMonth.getMonth()] + ', ' + currentMonth.getFullYear();
				lblNutMonthlyAvg.text = 'Average daily calories for\nthe month of ' + Constants.MONTHS[currentMonth.getMonth()];
			}
			
			private function createCustomTip(title:String, body:String, event:ToolTipEvent):void 
			{
				var myToolTip:FoodPlanToolTip = new FoodPlanToolTip();
				event.toolTip = myToolTip;
			}
			
			public function createCustomTipJournal(event:ToolTipEvent):void 
			{
				var myToolTip:FoodJournalToolTip = new FoodJournalToolTip();
				event.toolTip = myToolTip;
			}
			
			protected function onSetFoodPlanClick(event:MouseEvent):void
			{
			}
			
			private function downloadWorksheet():void 
			{
				var myDownloadWorksheet:downloadWorksheetWindow = downloadWorksheetWindow( PopUpManager.createPopUp(AppProperties.getInstance().controller.application, downloadWorksheetWindow) as spark.components.TitleWindow );
				
				PopUpManager.centerPopUp(myDownloadWorksheet);
			}
			
			private function nutCaloriesFillFunction(element:ChartItem, index:Number):IFill 
			{
				var transparent:SolidColor = new SolidColor(0x000000,0);	
				return model.weeklyCaloriesCurrent.getItemAt(index).calories <= 2000 ? transparent : lgBlue;
			}
			
			private function nutCaloriesExcessFillFunction(element:ChartItem, index:Number):IFill 
			{
				return nutJourWeeklyCalExcessSeries.items[index].xNumber <= 2000 ? lgBlue : lgRed;
			}
			
			private function nutNavigateDate(direction:String):void 
			{
				var meal:Object;
				
				//	if view == DAILY
				if( viewsNutritionJournal.selectedIndex == 0 ) 
				{
					if(direction == 'prev') currentDayDiff--;
					else currentDayDiff++;
					
					currentDailyPlate = (currentDayDiff == 0) ? 0 : (currentDailyPlate == 1) ? 2 : 1;
					showJournalPlate(currentDailyPlate);
					showCurrentDay();
					
					nutritionJournal.dataProvider = (currentDayDiff == 0) ? model.foodJournal : (currentDailyPlate == 1) ? model.foodJournalAlt2 : model.foodJournalAlt1;
					
					for each(meal in nutritionJournal.dataProvider) 
					{
						meal.date = DateUtil.get10DigitDate((currentDay.getMonth()+1)+'/'+currentDay.getDate()+'/'+currentDay.getFullYear())
					}
					
					if(currentDayDiff == 0) updateNutritionDatesDay('today');
					else if(currentDailyPlate == 1) updateNutritionDatesDay('alt1');
					else updateNutritionDatesDay('alt2');
				}
				//	if view == WEEKLY
				else if(viewsNutritionJournal.selectedIndex == 1) 
				{		
					if(direction == 'prev') currentWeekDiff--;
					else currentWeekDiff++;
					
					currentWeeklyPlate = (currentWeeklyPlate == 1) ? 2 : 1;
					showJournalPlate(currentWeeklyPlate);
					showCurrentWeek();
					
					nutritionJournal.dataProvider = (currentWeekDiff == 0) ? model.foodJournal : (currentWeeklyPlate == 1) ? model.foodJournalAlt2 : model.foodJournalAlt1;
					
					for each(meal in nutritionJournal.dataProvider) 
					{
						meal.date = DateUtil.get10DigitDate((currentSunday.getMonth()+1)+'/'+currentSunday.getDate()+'/'+currentSunday.getFullYear())
					}
					
					if(currentWeekDiff == 0) updateNutritionDatesWeek('thisWeek');
					else if(currentWeeklyPlate == 1) updateNutritionDatesWeek('alt1');
					else updateNutritionDatesWeek('alt2');
				}
				//if view == MONTHLY
				else 
				{
					if(direction == 'prev') currentMonthDiff--;
					else currentMonthDiff++;
					
					currentMonthlyPlate = (currentMonthlyPlate == 1) ? 2 : 1;
					showJournalPlate(currentMonthlyPlate);
					showCurrentMonth();
					
					nutritionJournal.dataProvider = (currentMonthDiff == 0) ? model.foodJournal : (currentMonthlyPlate == 1) ? model.foodJournalAlt2 : model.foodJournalAlt1;
					
					for each(meal in nutritionJournal.dataProvider) 
					{
						meal.date = DateUtil.get10DigitDate((currentMonth.getMonth()+1)+'/01/'+currentMonth.getFullYear())
					}
					
					if(currentMonthDiff == 0) updateNutritionDatesMonth('thisMonth');
					else if(currentMonthlyPlate == 1) updateNutritionDatesMonth('alt1');
					else updateNutritionDatesMonth('alt2');
				}
				
				updateMealSort();
			}
			
			private function updateMealSort():void
			{
				var sort:Sort = new Sort();
				sort.fields = [ new SortField('ingredients') ];
				nutritionJournal.dataProvider.sort = sort;
			}
			
			private function updateNutritionDatesDay(set:String):void 
			{
				if( set == 'today' ) 
				{
					model.dailyCaloriesCurrent = model.summaryCalories;
					imgNutGauge.source = !model.hasMealBeenSubmitted ? gaugeEmpty : model.mealType == 'full' ? gaugeFull : gaugePartial;
				}
				else if( set == 'alt1' ) 
				{
					model.dailyCaloriesCurrent = model.dailyCaloriesAlt1;
					imgNutGauge.source = gaugeAlmostFull;
				}
				else if(set == 'alt2' ) 
				{
					model.dailyCaloriesCurrent = model.dailyCaloriesAlt2;
					imgNutGauge.source = gaugeFull;
				}
				
				model.dailyCaloriesCurrent.refresh();
			}
			
			private function updateNutritionDatesWeek(set:String):void 
			{
				if(set == 'thisWeek') model.weeklyCaloriesCurrent = model.weeklyCalories;
				else if(set == 'alt1') model.weeklyCaloriesCurrent = model.weeklyCaloriesAlt1;
				else if(set == 'alt2') model.weeklyCaloriesCurrent = model.weeklyCaloriesAlt2;
				
				model.weeklyCaloriesCurrent.refresh();
				
				lblNutWeeklyAvgValue.text = String(avg(new Array(model.weeklyCaloriesCurrent.getItemAt(0).calories,model.weeklyCaloriesCurrent.getItemAt(1).calories,model.weeklyCaloriesCurrent.getItemAt(2).calories,model.weeklyCaloriesCurrent.getItemAt(3).calories,model.weeklyCaloriesCurrent.getItemAt(4).calories,model.weeklyCaloriesCurrent.getItemAt(5).calories,model.weeklyCaloriesCurrent.getItemAt(6).calories)));
			}
			
			private function updateNutritionDatesMonth(set:String):void
			{
				model.monthlyCalories = new ArrayCollection();
				
				var obj:Object;
				
				if( set == 'thisMonth' ) 
				{
					for(var i:uint = 0; i < 30; i++) 
					{
						obj = {day:(today.getMonth()+1) + '/' + (today.getDate()-(30 - i)) + '/' + today.getFullYear(), calories:arrMonthlyCalories1[i], goal:2000};
						model.monthlyCalories.addItem(obj);
					}
					
					lblNutMonthlyAvgValue.text = String(avg(arrMonthlyCalories1));
				}
				else if( set == 'alt1' ) 
				{
					for(var j:uint = 0; j < 30; j++) 
					{
						obj = {day:(currentMonth.getMonth()+1) + '/' + (j+1) + '/' + currentMonth.getFullYear(), calories:arrMonthlyCalories2[j], goal:2000};
						model.monthlyCalories.addItem(obj);
					}
					
					lblNutMonthlyAvgValue.text = String(avg(arrMonthlyCalories2));
				}
				else if(set == 'alt2') 
				{
					for(var k:uint = 0; k < 30; k++) 
					{
						obj = {day:(currentMonth.getMonth()+1) + '/' + (k+1) + '/' + currentMonth.getFullYear(), calories:arrMonthlyCalories3[k], goal:2000};
						model.monthlyCalories.addItem(obj);
					}
					lblNutMonthlyAvgValue.text = String(avg(arrMonthlyCalories3));
				}
				model.monthlyCalories.refresh();
			}
			
			private var ge1:GradientEntry = new GradientEntry(0xC2E1DF, 0);
			private var ge2:GradientEntry = new GradientEntry(0x51B6B2, .5);
			private var ge3:GradientEntry = new GradientEntry(0x6FD2B2, 1);	
			private var lgBlue:LinearGradient = new LinearGradient();
			private var ge4:GradientEntry = new GradientEntry(0xF6AF95, 0);
			private var ge5:GradientEntry = new GradientEntry(0xB71918, .5);
			private var ge6:GradientEntry = new GradientEntry(0xF6A763, 1);	
			private var lgRed:LinearGradient = new LinearGradient();
			
			private function showTip():void 
			{
				var myTipWindow:tips = tips(PopUpManager.createPopUp(AppProperties.getInstance().controller.application, tips) as spark.components.TitleWindow);
				PopUpManager.centerPopUp(myTipWindow);
			}
			
			private function init():void 
			{
				lgBlue.entries = [ge1, ge2, ge3];
				lgBlue.rotation = 90;
				lgRed.entries = [ge4, ge5, ge6];
				lgRed.rotation = 90;
				
				if( currentState == "default" ) showTip();
			}
		]]>
	</fx:Script>
	
	<components:ModuleHeader 
		id="header"
		icon="@Embed('/images/btnHome.png')"
		title="Nutrition" 
		actionSuffix="new notifications" actionCount="0" showActionsIfNone="true"
		showSearch="true" searchPlaceholder="Search Nutrition" showBackground="false" 
		visible="{showHeader}" includeInLayout="{showHeader}" />
	
	<s:Spacer height="10" />
	
	<s:Group>
		
		<mx:ViewStack id="viewStackNutrition" borderColor="0xBDBCBC" cornerRadius="2" backgroundColor="0x3C3C3B" borderVisible="true" borderStyle="solid" x="0" y="22" height="606">
			
			<s:NavigatorContent label="My Food Journal" creationPolicy="all">
				
				<s:layout>
					<s:VerticalLayout gap="0" />
				</s:layout>
				
				<s:BorderContainer height="40" width="100%" backgroundColor="0x706F6F">
					
					<s:layout>
						<s:HorizontalLayout verticalAlign="middle" paddingRight="6" paddingLeft="8"/>
					</s:layout>
					
					<s:Button label="Set Food Plan" styleName="buttonText" height="24" click="onSetFoodPlanClick(event)" visible="{currentState == 'provider'}" includeInLayout="{currentState == 'provider'}" />
					<s:Button label="Print My Food Journal" styleName="buttonText" height="24" />
					<s:Button label="Download Worksheet" styleName="buttonText" height="24" click="downloadWorksheet()" />
					
					<s:Spacer width="100%" />
					
					<s:HGroup color="0xFFFFFF" gap="2">
						<s:Label text="Time Range:" paddingTop="6" />
						<general:customLinkButton id="btnNut1d" label="{DateRanges.DAY}" click="setDateRange(DateRanges.DAY)" toggle="true" selected="{model.dateRange==DateRanges.DAY}" toggleBackgroundColor="0x4A4A49" skin="skins.general.MyLinkButtonSkin" paddingLeft="2" paddingRight="2" />
						<general:customLinkButton id="btnNut1wk" label="{DateRanges.WEEK}" click="setDateRange(DateRanges.WEEK)" toggle="true" selected="{model.dateRange==DateRanges.WEEK}" toggleBackgroundColor="0x4A4A49" skin="skins.general.MyLinkButtonSkin" paddingLeft="2" paddingRight="2" />
						<general:customLinkButton id="btnNut1mo" label="{DateRanges.MONTH}" click="setDateRange(DateRanges.MONTH)" toggle="true" selected="{model.dateRange==DateRanges.MONTH}" toggleBackgroundColor="0x4A4A49" skin="skins.general.MyLinkButtonSkin" paddingLeft="2" paddingRight="2" />
						<general:customLinkButton id="btnNut3mo" label="{DateRanges.MONTH_THREE}" click="setDateRange(DateRanges.MONTH_THREE)" selected="{model.dateRange==DateRanges.MONTH_THREE}" toggle="true" toggleBackgroundColor="0x4A4A49" skin="skins.general.MyLinkButtonSkin" paddingLeft="2" paddingRight="0" />
						<general:customLinkButton id="btnMedCustom" label="Custom" paddingLeft="2" paddingRight="2" />
					</s:HGroup>
					
					<s:HGroup gap="-1" visible="{btnNut1d || btnNut1wk.selected || btnNut1mo.selected}" includeInLayout="{btnNut1d || btnNut1wk.selected || btnNut1mo.selected}" paddingLeft="4" paddingRight="4">
						<s:Button id="btnNutLeft" width="28" height="24" icon="@Embed('/images/arrowLeft.png')" click="nutNavigateDate('prev')" />
						<s:Button id="btnNutRight" width="28" height="24" icon="@Embed('/images/arrowRight.png')" styleName="buttonText" click="nutNavigateDate('next')" enabled="{btnNut1d.selected ? (currentDayDiff &lt; 0) : btnNut1wk.selected ? (currentWeekDiff &lt; 0) : (currentMonthDiff &lt; 0)}" />
					</s:HGroup>
					
					<s:HGroup gap="0">
						<s:Button id="btnNutChart" width="29" height="24" icon="@Embed('/images/btnNutritionChart.png')" chromeColor="0xFF931E" /><!--click="switchExercisePerView(0);"-->
						<s:Button id="btnNutList" width="29" height="24" icon="@Embed('/images/btnCalendarMonth.png')" styleName="buttonText" /><!--click="switchExercisePerView(1);" click="switchVitalView(1)" PopUpManager.removePopUp(myChartPopup); (under click)-->
					</s:HGroup>
					
				</s:BorderContainer>
				
				<s:Line xFrom="0" xTo="974">
					<s:stroke>
						<s:SolidColorStroke color="#3F3E3D"/>
					</s:stroke>
				</s:Line>
				
				<s:Label id="nutJournalDate" text="{DateUtil.formatDateFromString((new Date().getMonth() + 1) + '/' + (new Date().getDate()) + '/' + (new Date().getFullYear()))}" styleName="greenBoldText" paddingTop="12" paddingBottom="16" paddingLeft="14" />
				
				<s:HGroup gap="10" paddingLeft="13">
					
					<s:VGroup gap="7">
						
						<s:HGroup verticalAlign="middle">
							<s:Label text="Record a Meal" styleName="greenSubtitleLarge" />
							<s:Image source="@Embed('/images/erBtnHelp.png')" buttonMode="true" click="showNutritionHelp()" />
						</s:HGroup>
						
						<s:BorderContainer width="277" height="256" styleName="transparentBorderContainerLight" fontSize="13">
							
							<s:layout>
								<s:VerticalLayout paddingTop="8" paddingLeft="13" paddingRight="13" />
							</s:layout>
							
							<s:HGroup gap="10">
								<s:DropDownList id="dropDownNutritionMealType" selectedIndex="0" styleName="buttonText" height="24" width="101"><!--change="dropDownVitalToEdit_changeHandler(event)"-->
									<s:dataProvider>
										<s:ArrayCollection>
											<fx:String>Breakfast</fx:String>
											<fx:String>Lunch</fx:String>
											<fx:String>Snack</fx:String>
											<fx:String>Dinner</fx:String>
										</s:ArrayCollection>							
									</s:dataProvider>
								</s:DropDownList>
								<s:DropDownList id="dropDownNutritionSavedMeal" prompt="Add a favorite meal" styleName="buttonText" height="24" width="142" dataProvider="{model.savedMeals.getItemAt(dropDownNutritionMealType.selectedIndex) as ArrayCollection}" /><!--change="dropDownVitalToEdit_changeHandler(event)"-->
							</s:HGroup>
							
							<s:Label text="Or submit a new food:" color="0xB3B3B3" fontStyle="italic" paddingTop="5" paddingBottom="-4" />
							
							<s:TextInput id="nutritionFoodSearch" text="Search" fontStyle="italic" color="0x4D4D4D" height="24" click="{if(nutritionFoodSearch.text == 'Search') nutritionFoodSearch.text = ''}" width="253" />
							
							<s:VGroup visible="{dropDownNutritionSavedMeal.selectedIndex > -1 || (nutritionFoodSearch.text != 'Search' &amp;&amp; nutritionFoodSearch.text != '')}">
								<s:Label text="What portion?" color="0xB3B3B3" fontStyle="italic" paddingTop="5" paddingBottom="-4" />
								
								<s:HGroup verticalAlign="middle" gap="10">
									
									<s:NumericStepper id="numPortion" maximum="1000" value="1" width="40" height="23" />
									
									<s:DropDownList id="nutritionPortionTypes" selectedIndex="0" styleName="buttonText" height="23" width="96">
										<s:layout>
											<s:VerticalLayout gap="0" horizontalAlign="contentJustify" requestedRowCount="7" />
										</s:layout>
										<s:dataProvider>
											<s:ArrayCollection>
												<fx:String>cups</fx:String>
												<fx:String>plates</fx:String>
												<fx:String>slices</fx:String>
												<fx:String>pieces</fx:String>
												<fx:String>bowls</fx:String>
												<fx:String>servings</fx:String>
												<fx:String>other</fx:String>
											</s:ArrayCollection>
										</s:dataProvider>
									</s:DropDownList>
									
									<s:TextInput id="nutritionPortionOther" color="0x4D4D4D" width="97" height="23" visible="{nutritionPortionTypes.selectedIndex == nutritionPortionTypes.dataProvider.length-1}" includeInLayout="{nutritionPortionTypes.selectedIndex == nutritionPortionTypes.dataProvider.length-1}" />
									
								</s:HGroup>
								
								<s:Label text="Comments (optional):" color="0xB3B3B3" fontStyle="italic" paddingTop="5" paddingBottom="-4" />
								
								<s:TextArea id="nutComments" width="253" height="46" fontStyle="italic" color="0x4D4D4D" text="Enter when, where, and why you had the meal." click="{if(nutComments.text == 'Enter when, where, and why you had the meal.') nutComments.text = ''}" />
								
							</s:VGroup>
							
							<s:HGroup paddingTop="4">
								<s:Line xFrom="0" xTo="253">
									<s:stroke>
										<s:SolidColorStroke color="0x4D4D4D" />
									</s:stroke>
								</s:Line>
							</s:HGroup>
							
							<s:HGroup paddingLeft="184" paddingTop="2">
								<s:Button label="Submit" styleName="buttonText" height="24" click="handleNutritionMealEntry()" />
							</s:HGroup>
							
						</s:BorderContainer>
						
						<s:Label text="Record Water Intake" styleName="greenSubtitleLarge" paddingTop="14" />
						
						<s:BorderContainer width="281" height="82" styleName="transparentBorderContainerLight">
							
							<s:layout>
								<s:VerticalLayout paddingTop="21" paddingLeft="13" />
							</s:layout>
							
							<s:HGroup paddingTop="4" gap="10">
								<s:Image source="@Embed('/images/nutritionGlassEmpty.png')" buttonMode="true" click="{glassesTaken = 1;}" visible="{glassesTaken &lt; 1}" includeInLayout="{glassesTaken &lt; 1}" />
								<s:Image source="@Embed('/images/nutritionGlassFull.png')" buttonMode="true" click="{glassesTaken = glassesTaken == 1 ? 0 : 1;}" visible="{glassesTaken >= 1}" includeInLayout="{glassesTaken >= 1}" />
								<s:Image source="@Embed('/images/nutritionGlassEmpty.png')" buttonMode="true" click="{glassesTaken = 2;}" visible="{glassesTaken &lt; 2}" includeInLayout="{glassesTaken &lt; 2}" />
								<s:Image source="@Embed('/images/nutritionGlassFull.png')" buttonMode="true" click="{glassesTaken = 2;}" visible="{glassesTaken >= 2}" includeInLayout="{glassesTaken >= 2}" />
								<s:Image source="@Embed('/images/nutritionGlassEmpty.png')" buttonMode="true" click="{glassesTaken = 3;}" visible="{glassesTaken &lt; 3}" includeInLayout="{glassesTaken &lt; 3}" />
								<s:Image source="@Embed('/images/nutritionGlassFull.png')" buttonMode="true" click="{glassesTaken = 3;}" visible="{glassesTaken >= 3}" includeInLayout="{glassesTaken >= 3}" />
								<s:Image source="@Embed('/images/nutritionGlassEmpty.png')" buttonMode="true" click="{glassesTaken = 4;}" visible="{glassesTaken &lt; 4}" includeInLayout="{glassesTaken &lt; 4}" />
								<s:Image source="@Embed('/images/nutritionGlassFull.png')" buttonMode="true" click="{glassesTaken = 4;}" visible="{glassesTaken >= 4}" includeInLayout="{glassesTaken >= 4}" />
								<s:Image source="@Embed('/images/nutritionGlassEmpty.png')" buttonMode="true" click="{glassesTaken = 5;}" visible="{glassesTaken &lt; 5}" includeInLayout="{glassesTaken &lt; 5}" />
								<s:Image source="@Embed('/images/nutritionGlassFull.png')" buttonMode="true" click="{glassesTaken = 5;}" visible="{glassesTaken >= 5}" includeInLayout="{glassesTaken >= 5}" />
								<s:Image source="@Embed('/images/nutritionGlassEmpty.png')" buttonMode="true" click="{glassesTaken = 6;}" visible="{glassesTaken &lt; 6}" includeInLayout="{glassesTaken &lt; 6}" />
								<s:Image source="@Embed('/images/nutritionGlassFull.png')" buttonMode="true" click="{glassesTaken = 6;}" visible="{glassesTaken >= 6}" includeInLayout="{glassesTaken >= 6}" />
								<s:Image source="@Embed('/images/nutritionGlassEmpty.png')" buttonMode="true" click="{glassesTaken = 7;}" visible="{glassesTaken &lt; 7}" includeInLayout="{glassesTaken &lt; 7}" />
								<s:Image source="@Embed('/images/nutritionGlassFull.png')" buttonMode="true" click="{glassesTaken = 7;}" visible="{glassesTaken >= 7}" includeInLayout="{glassesTaken >= 7}" />
								<s:Image source="@Embed('/images/nutritionGlassEmpty.png')" buttonMode="true" click="{glassesTaken = 8;}" visible="{glassesTaken &lt; 8}" includeInLayout="{glassesTaken &lt; 8}" />
								<s:Image source="@Embed('/images/nutritionGlassFull.png')" buttonMode="true" click="{glassesTaken = 8;}" visible="{glassesTaken >= 8}" includeInLayout="{glassesTaken >= 8}" />
							</s:HGroup>
							
							<s:Label text="{glassesTaken != 8 ? glassesTaken + ' cups' : '8+ cups'}" color="0xFFFFFF" fontSize="12" paddingTop="-1" paddingLeft="{glassesTaken &lt;= 1 ? -6 : (-6 + 30*(glassesTaken-1))}" />
							
						</s:BorderContainer>
						
					</s:VGroup>
					
					<s:VGroup>
						<s:Label text="Your Meal List" styleName="greenSubtitleLarge" paddingTop="1" paddingBottom="1" />
						
						<s:BorderContainer width="650" styleName="transparentBorderContainerLight">
							
							<s:layout>
								<s:VerticalLayout paddingTop="1" paddingLeft="1" paddingRight="1" />
							</s:layout>
							
							<mx:DataGrid 
								id="nutritionJournal" 
								width="100%"
								dataProvider="{model.foodJournal}" 
								styleName="standardDataGrid"
								rowCount="3"
								fontSize="12"
								paddingTop="4"
								headerHeight="27" rowHeight="27" horizontalGridLines="false" 
								itemRollOver="onNutritionRollOver(event)" itemRollOut="nutritionRollOverRowIndex=-2" 
								creationComplete="nutritionJournal.dispatchEvent(new DataGridEvent(DataGridEvent.HEADER_RELEASE,true,false,1))">
								
								<mx:columns> 
									<mx:DataGridColumn dataField="meal" headerText="Type" paddingLeft="5" width="70" />
									<mx:DataGridColumn dataField="ingredients" headerText="Food" width="164" paddingLeft="5" fontFamily="myMyriad">
										<mx:itemRenderer>
											<fx:Component>
												<mx:HBox width="184" paddingTop="-3" horizontalScrollPolicy="off">
													
													<fx:Script>
														<![CDATA[
															import events.ApplicationEvent;
															
															protected function deleteMeal():void 
															{
																var item:Object = outerDocument.nutritionJournal.selectedItem;
																var index:int = outerDocument.model.foodJournal.getItemIndex(item);
																
																outerDocument.model.foodJournal.removeItemAt(index);
																
																var evt:ApplicationEvent = new ApplicationEvent( ApplicationEvent.SHOW_STATUS, true );
																evt.data = "Your meal has been deleted";
																dispatchEvent( evt );
															}
														]]>
													</fx:Script>
													
													<mx:Label width="122" text="{data.ingredients}" fontSize="12" paddingTop="1" color="0xFFFFFF" selectable="false"/>
													
													<s:VGroup paddingTop="7" paddingLeft="-7" paddingRight="7" visible="{outerDocument.nutritionJournal.dataProvider.getItemIndex(data) == outerDocument.nutritionRollOverRowIndex}">
														<s:Image source="@Embed('/images/nutritionDelete.png')" toolTip="Delete" buttonMode="true" click="deleteMeal()" />
													</s:VGroup>
													
												</mx:HBox>
											</fx:Component>
										</mx:itemRenderer>
									</mx:DataGridColumn>
									<mx:DataGridColumn dataField="portion" headerText="Portion" width="63" paddingLeft="5" />
									<mx:DataGridColumn dataField="calories" headerText="Calories" width="63" paddingLeft="5" />
									<mx:DataGridColumn dataField="comments" headerText="Comments" width="216" paddingLeft="5" /><!--if you want to be able to truncate the text, you can use the following, but the embedded font doesn't work: itemRenderer="ASclasses.CustomRowColor"-->
									<mx:DataGridColumn headerText="Facts" width="70" paddingLeft="5" fontFamily="myMyriad">
										<mx:itemRenderer>
											<fx:Component>
												<mx:HBox width="184" paddingTop="-3" horizontalScrollPolicy="off" horizontalAlign="center">
													<s:VGroup paddingTop="4" paddingLeft="-7" paddingRight="7" visible="{data.ingredients == 'Spinach quiche'}">
														<s:Image source="@Embed('/images/info.png')" toolTip=" " toolTipCreate="{if(data.ingredients == 'Spinach quiche') outerDocument.createCustomTipJournal(event)}" />
													</s:VGroup>
												</mx:HBox>
											</fx:Component>
										</mx:itemRenderer>
									</mx:DataGridColumn>
									<mx:DataGridColumn dataField="meal" headerText="Favorite" width="70">
										<mx:itemRenderer>
											<fx:Component>
												<mx:HBox width="100%" horizontalScrollPolicy="off" horizontalAlign="center">
													<fx:Script>
														<![CDATA[
															import components.popups.nutrition.saveMealWindow;
															
															import events.ApplicationEvent;
															
															import mx.controls.Alert;
															import mx.controls.CheckBox;
															import mx.events.CloseEvent;
															import mx.managers.PopUpManager;
															import mx.collections.ArrayCollection;
															
															import spark.components.TitleWindow;
															
															[Bindable] private var mealSaved:Boolean;
															
															private function saveMeal():void
															{
																 
																var item:Object = outerDocument.nutritionJournal.selectedItem;
																var index:int = outerDocument.model.foodJournal.getItemIndex(item);
																outerDocument.model.savedMeals[ outerDocument.mealTypes.indexOf( outerDocument.model.foodJournal.getItemAt(index).meal ) ].addItem( outerDocument.model.foodJournal.getItemAt(index).ingredients );
																
																var evt:ApplicationEvent = new ApplicationEvent( ApplicationEvent.SHOW_STATUS, true );
																evt.data = "Your meal has been saved as a favorite";
																AppProperties.getInstance().controller.application.dispatchEvent( evt );
																
																update();
															} 
															
															private function removeSavedMeal():void
															{
																var index:int = outerDocument.model.savedMeals.getItemAt( outerDocument.mealTypes.indexOf( data.meal ) ).getItemIndex( data.ingredients );
																
																if( index > -1 )
																{
																	ArrayCollection( outerDocument.model.savedMeals.getItemAt( outerDocument.mealTypes.indexOf( data.meal ) ) ).removeItemAt( index );
																}
																
																update();
															}
															
															private function update():void
															{
																mealSaved = outerDocument.model.savedMeals.getItemAt( outerDocument.mealTypes.indexOf( data.meal ) ).getItemIndex( data.ingredients ) > -1;
															}
														]]>
													</fx:Script>
													
													<mx:Image source="@Embed(source='/images/nutritionFavorite.png')" visible="{mealSaved}" includeInLayout="{mealSaved}" click="removeSavedMeal()" />
													<mx:Image source="@Embed(source='/images/nutritionFavoriteNOT.png')" visible="{!mealSaved}" includeInLayout="{!mealSaved}" click="saveMeal()" />
													
												</mx:HBox>
											</fx:Component>
										</mx:itemRenderer>
									</mx:DataGridColumn>
								</mx:columns> 
							</mx:DataGrid>
							
						</s:BorderContainer>
						
						<s:HGroup paddingTop="14" gap="14">
							<s:VGroup>
								<s:Label text="Total Calories Taken" styleName="greenSubtitleLarge" />
								<mx:ViewStack id="viewsNutritionJournal" height="308" creationPolicy="all">
									
									<s:NavigatorContent creationPolicy="all">
										
										<s:layout>
											<s:VerticalLayout />
										</s:layout>
										
										<s:HGroup gap="18" paddingTop="16" paddingLeft="12" paddingBottom="15">
											<s:VGroup>
												<s:Image id="imgNutGauge" source="{!model.hasMealBeenSubmitted ? gaugeEmpty : model.mealType == 'full' ? gaugeFull : gaugePartial}" />
											</s:VGroup>
											<s:VGroup gap="0" paddingTop="-4">
												<s:HGroup>
													<s:Label text="{model.dailyCaloriesCurrent.getItemAt(0).calories}" styleName="orangeStandout" />
													<s:Label text="Cals." fontSize="24" color="0xFFFFFF" paddingTop="9" />
												</s:HGroup>
												<s:Label color="0xFFFFFF" fontSize="14" text="Daily Budget: 2,000 Calories" />
											</s:VGroup>
										</s:HGroup>
										
										<s:VGroup gap="2">
											<s:Line xFrom="0" xTo="309">
												<s:stroke>
													<s:SolidColorStroke color="#BDBCBC" weight="1" alpha=".75" />
												</s:stroke>
											</s:Line>
											<s:Line xFrom="0" xTo="309">
												<s:stroke>
													<s:SolidColorStroke color="#BDBCBC" weight="1" alpha=".75" />
												</s:stroke>
											</s:Line>
										</s:VGroup>
										
										<s:VGroup width="253" paddingLeft="28">
											<s:HGroup color="0xFFFFFF" paddingTop="14" paddingLeft="24">
												<s:Image source="@Embed('/images/nutritionJournalFood.png')" />
												<s:Label text="{'+ ' + model.dailyCaloriesCurrent.getItemAt(0).calories}" textAlign="right" width="57" fontSize="16" paddingRight="8" />
												<s:Label text="Cals. Taken" fontSize="14" />
											</s:HGroup>
											
											<s:HGroup color="0xFFFFFF" paddingTop="2" paddingBottom="1" paddingLeft="24">
												<s:Image source="@Embed('/images/nutritionJournalExercise.png')" />
												<s:Label text="- 0" textAlign="right" width="57" fontSize="16" paddingRight="8" />
												<s:Label text="Cals. Burned" fontSize="14" />
											</s:HGroup>
											
											<s:Line xFrom="0" xTo="253">
												<s:stroke>
													<s:SolidColorStroke color="#666666" />
												</s:stroke>
											</s:Line>
											
											<s:HGroup paddingTop="-6" paddingBottom="31">
												<s:BorderContainer backgroundColor="0xFFFFFF" backgroundAlpha=".1" borderVisible="false" color="0xFFFFFF" width="253" height="37" fontWeight="bold">
													<s:layout>
														<s:HorizontalLayout paddingLeft="10" paddingTop="7" gap="13" />
													</s:layout>
													<s:Label text="{'+' + model.dailyCaloriesCurrent.getItemAt(0).calories}" fontSize="24" width="85" textAlign="right" />
													<s:Label text="Total Calories Taken" fontSize="14" paddingTop="7" />
												</s:BorderContainer>
											</s:HGroup>
											
											<s:HGroup color="0xFFFFFF" paddingLeft="22">
												<s:VGroup paddingTop="-3">
													<s:Image source="@Embed('/images/nutritionNewFatsOilsSM.png')" />
												</s:VGroup>
												<s:Label text="{'+' + model.dailyCaloriesCurrent.getItemAt(0).extrasFats}" textAlign="right" width="54" fontSize="16" paddingRight="8" />
												<s:Label text="Cals. From Fats &amp; Oils" fontSize="14" />
											</s:HGroup>
											
											<s:HGroup color="0xFFFFFF" paddingTop="1" paddingLeft="22">
												<s:VGroup paddingTop="-3">
													<s:Image source="@Embed('/images/nutritionNewSugarsSM.png')" />
												</s:VGroup>
												<s:Label text="{'+' + model.dailyCaloriesCurrent.getItemAt(0).extrasSugar}" textAlign="right" width="54" fontSize="16" paddingRight="8" />
												<s:Label text="Cals. From Sugar" fontSize="14" />
											</s:HGroup>
											
											<s:HGroup color="0xFFFFFF" paddingTop="1" paddingLeft="22">
												<s:VGroup paddingTop="-3">
													<s:Image source="@Embed('/images/nutritionNewAlcoholSM.png')" />
												</s:VGroup>
												<s:Label text="{'+' + model.dailyCaloriesCurrent.getItemAt(0).extrasAlcohol}" textAlign="right" width="54" fontSize="16" paddingRight="8" />
												<s:Label text="Cals. From Alcohol" fontSize="14" />
											</s:HGroup>
											
											<s:Line xFrom="0" xTo="253">
												<s:stroke>
													<s:SolidColorStroke color="#666666" />
												</s:stroke>
											</s:Line>
											
											<s:HGroup paddingTop="-6">
												<s:BorderContainer backgroundColor="0xFFFFFF" backgroundAlpha=".1" borderVisible="false" color="0xFFFFFF" width="253" height="37" fontWeight="bold">
													<s:layout>
														<s:HorizontalLayout paddingLeft="10" paddingTop="7" gap="13" />
													</s:layout>
													<s:Label text="{'+' + model.dailyCaloriesCurrent.getItemAt(0).caloriesFromExtras}" fontSize="24" width="85" textAlign="right" />
													<s:Label text="Calories from Extra" fontSize="14" paddingTop="7" />
												</s:BorderContainer>
											</s:HGroup>
											
											<!--<s:HGroup paddingTop="38" gap="2">
											<s:Label text="Calories from Extras" styleName="greenBoldText" />
											<s:Label text="(fats &amp; oils, sugars, and alcohol)" fontSize="13" fontStyle="italic" color="0xCCCCCC" />
											</s:HGroup>
											
											<s:HGroup fontSize="13" color="0xFFFFFF" gap="3" visible="{model.dailyCaloriesCurrent.getItemAt(0).calories > 0}" includeInLayout="{model.dailyCaloriesCurrent.getItemAt(0).calories > 0}">
											<s:Label text="Of" />
											<s:Label text="{model.dailyCaloriesCurrent.getItemAt(0).calories + ' total calories'}" fontWeight="bold" fontStyle="italic" color="0xFF931E" />
											<s:Label text="," paddingLeft="-3" />
											<s:Label text="{model.dailyCaloriesCurrent.getItemAt(0).caloriesFromExtras + ' calories'}" fontWeight="bold" fontStyle="italic" color="0xFF931E" />
											<s:Label text="are from extras." />
											</s:HGroup>
											
											<s:Label id="lblNutJournalLabels" text="{nutLabelsCurrent}" color="#FFFFFF" fontSize="11" paddingTop="10" paddingBottom="-6" />
											
											<mx:BarChart id="nutJournalCaloriesFromExtras" dataProvider="{model.dailyCaloriesCurrent}" height="20" width="278" paddingBottom="-8">
											
											<mx:series>
											<mx:BarSeries id="nutJournalCaloriesFromExtrasSeries" yField="type" xField="caloriesFromExtras" fillFunction="nutJournalCaloriesFromExtrasFillFunction" />
											</mx:series>
											
											<mx:verticalAxis>
											<mx:CategoryAxis id="nutJournalCaloriesFromExtrasYaxis" categoryField="type" />
											</mx:verticalAxis>
											
											<mx:verticalAxisRenderers>
											<mx:AxisRenderer axis="{nutJournalCaloriesFromExtrasYaxis}" showLabels="false" showLine="false" />
											<mx:AxisRenderer axis="{nutJournalCaloriesFromExtrasYaxis}" showLabels="false" placement="right">
											<mx:axisStroke>
											<mx:SolidColorStroke color="#B3B3B3" weight="1" caps="none" />
											</mx:axisStroke>
											</mx:AxisRenderer>
											</mx:verticalAxisRenderers>
											
											<mx:horizontalAxis>
											<mx:LinearAxis id="nutJournalCaloriesFromExtrasXaxis" minimum="0" maximum="{nutCaloriesXaxisMaximumCurrent}" interval="100" />
											</mx:horizontalAxis>
											
											<mx:horizontalAxisRenderers>
											<mx:AxisRenderer axis="{nutJournalCaloriesFromExtrasXaxis}" showLabels="false" tickPlacement="none" minorTickPlacement="none" placement="top">
											<mx:axisStroke>
											<mx:SolidColorStroke color="#B3B3B3" weight="1" caps="none" />
											</mx:axisStroke>
											</mx:AxisRenderer>
											<mx:AxisRenderer axis="{nutJournalCaloriesFromExtrasXaxis}" showLabels="false" tickPlacement="none" minorTickPlacement="none" placement="bottom">
											<mx:axisStroke>
											<mx:SolidColorStroke color="#B3B3B3" weight="1" caps="none" />
											</mx:axisStroke>
											</mx:AxisRenderer>
											</mx:horizontalAxisRenderers>
											
											</mx:BarChart>	-->
										</s:VGroup>
										
									</s:NavigatorContent>
									
									<s:NavigatorContent creationPolicy="all">
										
										<s:layout>
											<s:VerticalLayout />
										</s:layout>
										
										<s:HGroup gap="3" fontSize="13" paddingBottom="11">
											<s:Label color="0xFFFFFF" text="Daily Calorie Budget:" />
											<s:Label color="0xFF931E" fontStyle="italic" text="2000 calories" />
										</s:HGroup>
										
										<s:Label text="0                400              800             1200           1600        2000 cals." color="#FFFFFF" fontSize="11" paddingBottom="-6" paddingLeft="39" />
										
										<mx:BarChart id="nutFoodJournalWeeklyCalories" dataProvider="{model.weeklyCaloriesCurrent}" type="overlaid" height="165" width="314" showDataTips="true"><!--backgroundElements="{nutritionJournalBGE}"-->
											<mx:series>
												<mx:BarSeries id="nutJourWeeklyCalExcessSeries" yField="day" xField="calories" fillFunction="nutCaloriesExcessFillFunction">
													<!--<mx:fill>
													<mx:LinearGradient rotation="90">
													<mx:entries>
													<mx:GradientEntry color="0xF6AF95" ratio="0.00" />
													<mx:GradientEntry color="0xB71918" ratio="0.5" />
													<mx:GradientEntry color="0xF6A763" ratio="1" />
													</mx:entries>
													</mx:LinearGradient>
													</mx:fill>-->
												</mx:BarSeries>
												<!-- if u want to use this for multiple 'series', maybe just leave the xField static, and write a fillFunction for each barseries that will check if there's an excess, and if so show the appropriate colors and invisibilities-->
												<mx:BarSeries id="nutJourWeeklyCaloriesSeries" yField="day" xField="limit" fillFunction="nutCaloriesFillFunction" interactive="false"><!--fillFunction="nutCaloriesFillFunction"-->
													<!--<mx:fill>
													<mx:LinearGradient rotation="90">
													<mx:entries>
													<mx:GradientEntry color="0xC2E1DF" ratio="0.00" />
													<mx:GradientEntry color="0x51B6B2" ratio="0.5" />
													<mx:GradientEntry color="0x6FD2B2" ratio="1" />
													</mx:entries>
													</mx:LinearGradient>
													</mx:fill>-->
												</mx:BarSeries>
												<!--<mx:BarSeries id="dummy" xField="calories">
												<mx:fill>
												<s:SolidColor alpha="0" />
												</mx:fill>
												</mx:BarSeries>-->
											</mx:series>
											
											<mx:verticalAxis>
												<mx:CategoryAxis id="nutJourSummaryWeeklyCaloriesYaxis" categoryField="day" />
											</mx:verticalAxis>
											
											<mx:verticalAxisRenderers>
												<mx:AxisRenderer axis="{nutJourSummaryWeeklyCaloriesYaxis}" showLine="false" color="0xFFFFFF" fontSize="13" />
												<!--<mx:AxisRenderer axis="{nutJourSummaryWeeklyCaloriesYaxis}" showLabels="false" placement="right">
												<mx:axisStroke>
												<mx:SolidColorStroke color="#FF0000" weight="1" caps="none" />
												</mx:axisStroke>
												</mx:AxisRenderer>-->
											</mx:verticalAxisRenderers>
											
											<mx:horizontalAxis>
												<mx:LinearAxis id="nutJourSummaryWeeklyCaloriesXaxis" minimum="0" maximum="2200" interval="400" />
											</mx:horizontalAxis>
											
											<mx:horizontalAxisRenderers>
												<!--<mx:AxisRenderer axis="{nutJourSummaryWeeklyCaloriesXaxis}" showLabels="false" tickPlacement="none" minorTickPlacement="none" placement="top">
												<mx:axisStroke>
												<mx:SolidColorStroke color="#B3B3B3" weight="1" alpha=".7" caps="none" />
												</mx:axisStroke>
												</mx:AxisRenderer>
												<mx:AxisRenderer axis="{nutJourSummaryWeeklyCaloriesXaxis}" showLabels="false" tickPlacement="none" minorTickPlacement="none" placement="bottom">
												<mx:axisStroke>
												<mx:SolidColorStroke color="#B3B3B3" weight="1" alpha=".7" caps="none" />
												</mx:axisStroke>
												</mx:AxisRenderer>-->
												<mx:AxisRenderer axis="{nutJourSummaryWeeklyCaloriesXaxis}" showLabels="false" showLine="false" tickPlacement="none" minorTickPlacement="none" />
											</mx:horizontalAxisRenderers>
										</mx:BarChart>
										
										<s:VGroup paddingTop="20">
											<s:BorderContainer width="305" height="43" backgroundColor="0xFFFFFF" backgroundAlpha=".1" borderVisible="false">
												<s:layout>
													<s:HorizontalLayout paddingLeft="38" verticalAlign="middle" gap="9" paddingTop="2" />
												</s:layout>
												<s:Label id="lblNutWeeklyAvgValue" text="{avg(new Array(model.weeklyCaloriesCurrent.getItemAt(0).calories,model.weeklyCaloriesCurrent.getItemAt(1).calories,model.weeklyCaloriesCurrent.getItemAt(2).calories,model.weeklyCaloriesCurrent.getItemAt(3).calories,model.weeklyCaloriesCurrent.getItemAt(4).calories,model.weeklyCaloriesCurrent.getItemAt(5).calories,model.weeklyCaloriesCurrent.getItemAt(6).calories))}" styleName="orangeStandout" />
												<s:Label text="{'Average daily calories\nconsumed for this week'}" color="0xFFFFFF" fontSize="14" />
											</s:BorderContainer>
										</s:VGroup>
										
									</s:NavigatorContent>
									
									<s:NavigatorContent creationPolicy="all">
										
										<s:layout>
											<s:VerticalLayout />
										</s:layout>
										
										<s:HGroup gap="3" fontSize="13" paddingBottom="11">
											<s:Label color="0xFFFFFF" text="Daily Calorie Budget:" />
											<s:Label color="0xFF931E" fontStyle="italic" text="2000 calories" />
										</s:HGroup>
										
										<s:HGroup paddingLeft="-50" verticalAlign="middle">
											
											<mx:LineChart id="nutFoodJournalMonthlyCalories" dataProvider="{model.monthlyCalories}" showDataTips="true" height="176" width="348" backgroundElements="{bge}" seriesFilters="[]">
												<mx:series>
													<mx:LineSeries yField="goal" xField="day" interactive="false">
														<mx:lineStroke>
															<s:SolidColorStroke color="0xFF0000" weight="2" alpha="0.45" />
														</mx:lineStroke>
													</mx:LineSeries>
													<mx:LineSeries yField="calories" xField="day">
														<mx:lineStroke>
															<s:SolidColorStroke color="0x51B6B2" weight="3" />
														</mx:lineStroke>
													</mx:LineSeries>
												</mx:series>
												<mx:horizontalAxis>
													<mx:DateTimeAxis id="nutJourMonthlyCaloriesXAxis" />
												</mx:horizontalAxis>
												<mx:horizontalAxisRenderers>
													<mx:AxisRenderer axis="{nutJourMonthlyCaloriesXAxis}" color="0xFFFFFF" fontSize="12" tickPlacement="none" />
												</mx:horizontalAxisRenderers>
												<mx:verticalAxis>
													<mx:LinearAxis id="nutJourMonthlyCaloriesYaxis" maximum="3500" minimum="0" />
												</mx:verticalAxis>
												<mx:verticalAxisRenderers>
													<mx:AxisRenderer axis="{nutJourMonthlyCaloriesYaxis}" visible="false" />
												</mx:verticalAxisRenderers>
											</mx:LineChart>
											<s:Label text="{'2000\ncals.'}" color="0xFFFFFF" fontSize="13" lineHeight="13" paddingTop="-34" paddingLeft="-25" />
										</s:HGroup>
										
										<s:VGroup paddingTop="20">
											<s:BorderContainer width="305" height="43" backgroundColor="0xFFFFFF" backgroundAlpha=".1" borderVisible="false">
												<s:layout>
													<s:HorizontalLayout paddingLeft="38" verticalAlign="middle" gap="9" paddingTop="2" />
												</s:layout>
												<s:Label id="lblNutMonthlyAvgValue" text="{avg(arrMonthlyCalories1)}" styleName="orangeStandout" />
												<s:Label id="lblNutMonthlyAvg" text="{'Average daily calories for\nthe month of September'}" color="0xFFFFFF" fontSize="14" />
											</s:BorderContainer>
										</s:VGroup>
										
									</s:NavigatorContent>
									
								</mx:ViewStack>
							</s:VGroup>
							
							<s:Line yFrom="0" yTo="361">
								<s:stroke>
									<s:SolidColorStroke color="#666666"/>
								</s:stroke>
							</s:Line>
							
							<s:VGroup>
								<s:Label text="Your Food Plate" styleName="greenSubtitleLarge" />
								
								<mx:LinkButton id="btnNutReadComment" visible="false" label="Read Comment" icon="{iconComment}" fontSize="11" fontStyle="italic" paddingLeft="0" color="0xFF931E" textRollOverColor="0xFF931E" textSelectedColor="0xFF931E" skin="{null}" rollOver="{btnNutReadComment.styleName='linkBtnUnderline';}" rollOut="btnNutReadComment.styleName='linkBtn';" />
								
								<s:HGroup paddingTop="-18" width="100%" horizontalAlign="center">
									<s:Image id="imgNutJournalMyPlate" source="{!model.hasMealBeenSubmitted ? plateEmpty : model.mealType == 'full' ? plateFull : platePartial}" />
								</s:HGroup>
								
								<s:HGroup verticalAlign="middle" gap="7" paddingTop="18">
									<s:Label width="50" textAlign="right" color="0xBED63A" fontSize="12" paddingTop="2" text="Sodium" />
									<s:Image source="@Embed('/images/nutritionNewSodiumLG.png')" />
									<s:VGroup gap="1" paddingTop="-10">
										<s:Label width="200" textAlign="right" fontSize="11" fontStyle="italic" color="0xCCCCCC" text="2,000 mg" />
										<s:Image id="imgSodiumChart" source="{!model.hasMealBeenSubmitted ? newChartSodium0 : model.mealType == 'full' ? newChartSodium2 : newChartSodium1}" />
									</s:VGroup>
								</s:HGroup>
								
								<s:HGroup verticalAlign="middle" gap="7" paddingTop="12">
									<s:Label width="50" textAlign="right" color="0xBED63A" fontSize="12" paddingTop="2" text="{'Fats\n&amp; Oils'}" />
									<s:Image source="@Embed('/images/nutritionNewFatsOilsLG.png')" />
									<s:VGroup gap="1" paddingTop="-10">
										<s:Label width="200" textAlign="right" fontSize="11" fontStyle="italic" color="0xCCCCCC" text="2 - 3 servings" />
										<s:Image id="imgFatsOilsChart" source="{!model.hasMealBeenSubmitted ? newChartFatsOils0 : model.mealType == 'full' ? newChartFatsOils2 : newChartFatsOils1}" />
									</s:VGroup>
								</s:HGroup>
								
								<s:HGroup verticalAlign="middle" gap="7" paddingTop="12">
									<s:Label width="50" textAlign="right" color="0xBED63A" fontSize="12" paddingTop="2" text="Sugar" />
									<s:Image source="@Embed('/images/nutritionNewSugarLG.png')" />
									<s:VGroup gap="1" paddingTop="-10">
										<s:Label width="200" textAlign="right" fontSize="11" fontStyle="italic" color="0xCCCCCC" text="Less than 1 serving" />
										<s:Image id="imgSugarChart" source="{!model.hasMealBeenSubmitted ? newChartSugar0 : model.mealType == 'full' ? newChartSugar2 : newChartSugar1}" />
									</s:VGroup>
								</s:HGroup>
								
								<s:HGroup verticalAlign="middle" gap="7" paddingTop="12">
									<s:Label width="50" textAlign="right" color="0xBED63A" fontSize="12" paddingTop="2" text="Alcohol" />
									<s:Image source="@Embed('/images/nutritionNewAlcoholLG.png')" />
									<s:VGroup gap="1" paddingTop="-10">
										<s:Label width="200" textAlign="right" fontSize="11" fontStyle="italic" color="0xCCCCCC" text="Less than 2 drinks" />
										<s:Image id="imgAlcoholChart" source="{!model.hasMealBeenSubmitted ? newChartAlcohol0 : model.mealType == 'full' ? newChartAlcohol2 : newChartAlcohol0}" />
									</s:VGroup>
								</s:HGroup>
								
								<!--<s:Label text="Total Calories" styleName="subtitles" fontWeight="normal" paddingTop="11" />
								
								<s:Label text="0                  400                800               1200             1600          2000 cals." color="#FFFFFF" fontSize="11" paddingBottom="-6" />
								
								<mx:BarChart id="nutSummaryCalories" dataProvider="{model.summaryCalories}" height="28" width="278">--><!--type="overlaid"-->
									
									<!--<mx:series>-->
										
										<!--
										<mx:BarSeries id="nutCalExcessSeries" yField="type" xField="calories" visible="{model.summaryCalories.getItemAt(0).calories > model.summaryCalories.getItemAt(0).goal}">
										<mx:fill>
										<mx:LinearGradient rotation="90">
										<mx:entries>
										<mx:GradientEntry color="0xFFFF9F" ratio="0.00" />
										<mx:GradientEntry color="0xFFC500" ratio="0.5" />
										<mx:GradientEntry color="0xF5FFB2" ratio="1" />
										</mx:entries>
										</mx:LinearGradient>
										</mx:fill>
										</mx:BarSeries>
										-->
										
										<!-- if u want to use this for multiple 'series', maybe just leave the xField static, and write a fillFunction for each barseries that will check if there's an excess, and if so show the appropriate colors and invisibilities-->
										<!--<mx:BarSeries id="nutCaloriesSeries" yField="type" xField="calories">-->	<!--xField="{model.summaryCalories.getItemAt(0).calories > model.summaryCalories.getItemAt(0).goal ? 'goal' : 'calories'}"--><!--if calories exceeds the goal, then we show this blue bar only up to the goal (and the rest are separate extra calories), else we show the calories number-->
							<!--				<mx:fill>
												<mx:LinearGradient rotation="90">
													<mx:entries>
														<mx:GradientEntry color="0xC2E1DF" ratio="0.00" />
														<mx:GradientEntry color="0x51B6B2" ratio="0.5" />
														<mx:GradientEntry color="0x6FD2B2" ratio="1" />
													</mx:entries>
												</mx:LinearGradient>
											</mx:fill>
										</mx:BarSeries>
										
									</mx:series>
									
									<mx:verticalAxis>
										<mx:CategoryAxis id="nutSummaryCaloriesYaxis" categoryField="type" />
									</mx:verticalAxis>
									
									<mx:verticalAxisRenderers>
										<mx:AxisRenderer axis="{nutSummaryCaloriesYaxis}" showLabels="false" showLine="false" />
										<mx:AxisRenderer axis="{nutSummaryCaloriesYaxis}" showLabels="false" placement="right">
											<mx:axisStroke>
												<mx:SolidColorStroke color="#B3B3B3" weight="1" caps="none" />
											</mx:axisStroke>
										</mx:AxisRenderer>
									</mx:verticalAxisRenderers>
									
									<mx:horizontalAxis>
										<mx:LinearAxis id="nutSummaryCaloriesXaxis" minimum="0" maximum="2000" interval="400" />
									</mx:horizontalAxis>
									
									<mx:horizontalAxisRenderers>
										<mx:AxisRenderer axis="{nutSummaryCaloriesXaxis}" showLabels="false" tickPlacement="none" minorTickPlacement="none" placement="top">
											<mx:axisStroke>
												<mx:SolidColorStroke color="#B3B3B3" weight="1" caps="none" />
											</mx:axisStroke>
										</mx:AxisRenderer>
										<mx:AxisRenderer axis="{nutSummaryCaloriesXaxis}" showLabels="false" tickPlacement="none" minorTickPlacement="none" placement="bottom">
											<mx:axisStroke>
												<mx:SolidColorStroke color="#B3B3B3" weight="1" caps="none" />
											</mx:axisStroke>
										</mx:AxisRenderer>
									</mx:horizontalAxisRenderers>
									
								</mx:BarChart>
								
								<s:HGroup paddingTop="11" paddingBottom="-4" gap="2">
									<s:Label text="Calories from Extras" styleName="subtitles" fontWeight="normal" />
									<s:Label text="(fats &amp; oils, sugars, and alcohol)" fontSize="12" fontStyle="italic" color="0xCCCCCC" />
								</s:HGroup>
								
								<s:Label 
									text="{model.summaryCalories.getItemAt(0).caloriesFromExtras &lt;= 500 ? model.summaryCalories.getItemAt(0).caloriesFromExtras + ' cals.' : model.summaryCalories.getItemAt(0).caloriesFromExtras + ' cals. I\'m exceeding my calories budget from extras.'}" 
									fontSize="11" fontStyle="italic" color="{model.summaryCalories.getItemAt(0).caloriesFromExtras &lt;= 500 ? 0xFF931E : 0xDD0000}" 
									fontWeight="{model.summaryCalories.getItemAt(0).caloriesFromExtras &lt;= 500 ? 'normal' : 'bold'}" 
									visible="{model.hasMealBeenSubmitted}" />
								
								<s:Label id="lblNutSummaryLabels" text="{nutLabelsToday}" color="#FFFFFF" fontSize="11" paddingBottom="-6" />
								
								<mx:BarChart id="nutSummaryCaloriesFromExtras" dataProvider="{model.summaryCalories}" height="20" width="278" paddingBottom="-8">
									
									<mx:series>
										<mx:BarSeries id="nutCaloriesFromExtrasSeries" yField="type" xField="caloriesFromExtras" fillFunction="nutCaloriesFromExtrasFillFunction" />
									</mx:series>
									
									<mx:verticalAxis>
										<mx:CategoryAxis id="nutSummaryCaloriesFromExtrasYaxis" categoryField="type" />
									</mx:verticalAxis>
									
									<mx:verticalAxisRenderers>
										<mx:AxisRenderer axis="{nutSummaryCaloriesFromExtrasYaxis}" showLabels="false" showLine="false" />
										<mx:AxisRenderer axis="{nutSummaryCaloriesFromExtrasYaxis}" showLabels="false" placement="right">
											<mx:axisStroke>
												<mx:SolidColorStroke color="#B3B3B3" weight="1" caps="none" />
											</mx:axisStroke>
										</mx:AxisRenderer>
									</mx:verticalAxisRenderers>
									
									<mx:horizontalAxis>
										<mx:LinearAxis id="nutSummaryCaloriesFromExtrasXaxis" minimum="0" maximum="{nutCaloriesXaxisMaximumToday}" interval="100" />
									</mx:horizontalAxis>
									
									<mx:horizontalAxisRenderers>
										<mx:AxisRenderer axis="{nutSummaryCaloriesFromExtrasXaxis}" showLabels="false" tickPlacement="none" minorTickPlacement="none" placement="top">
											<mx:axisStroke>
												<mx:SolidColorStroke color="#B3B3B3" weight="1" caps="none" />
											</mx:axisStroke>
										</mx:AxisRenderer>
										<mx:AxisRenderer axis="{nutSummaryCaloriesFromExtrasXaxis}" showLabels="false" tickPlacement="none" minorTickPlacement="none" placement="bottom">
											<mx:axisStroke>
												<mx:SolidColorStroke color="#B3B3B3" weight="1" caps="none" />
											</mx:axisStroke>
										</mx:AxisRenderer>
									</mx:horizontalAxisRenderers>
								</mx:BarChart>
								
								<mx:LinkButton 
									id="btnNutEducational" 
									label="Learn how to improve your diet »" 
									color="0xAEDEE4" textRollOverColor="0xAEDEE4" textSelectedColor="0xAEDEE4" skin="{null}" 
									paddingLeft="0" 
									rollOver="{btnNutEducational.styleName='linkBtnUnderline';}" 
									rollOut="btnNutEducational.styleName='linkBtn';" 
									visible="{model.summaryCalories.getItemAt(0).caloriesFromExtras > 500}" click="setState(Constants.MODULE_EDUCATIONAL_RESOURCES);" />
								
								<s:HGroup gap="16" paddingLeft="-12" paddingTop="6">
									<s:VGroup horizontalAlign="center" width="64">
										<s:Label text="Sodium" styleName="subtitles" fontWeight="normal" />
										<s:Image source="{!model.hasMealBeenSubmitted ? model.sodiumEmpty : model.mealType == 'full' ? model.sodiumFull : model.sodiumPartial}" />
										<s:Label text="{!model.hasMealBeenSubmitted ? '0 mg.' : model.mealType == 'full' ? '3,500 mg.' : '2,000 mg.'}" fontSize="11" color="0xCCCCCC" fontStyle="italic" />
									</s:VGroup>
									<s:VGroup horizontalAlign="center" width="64">
										<s:Label text="Fats &amp; Oils" styleName="subtitles" fontWeight="normal" />
										<s:Image source="{!model.hasMealBeenSubmitted ? model.fatsOilsEmpty : model.fatsOilsPartial}" />
										<s:Label text="{!model.hasMealBeenSubmitted ? '0 servings' : '2 - 3 servings'}" fontSize="11" color="0xCCCCCC" fontStyle="italic" />
									</s:VGroup>
									<s:VGroup horizontalAlign="center" width="64">
										<s:Label text="Sugars" styleName="subtitles" fontWeight="normal" />
										<s:Image source="{!model.hasMealBeenSubmitted ? model.sugarsEmpty : model.sugarsFull}" />
										<s:Label text="{!model.hasMealBeenSubmitted ? 'less than\n1 serving' : '2 - 3 servings'}" fontSize="11" color="0xCCCCCC" fontStyle="italic" textAlign="center" lineHeight="11" />
									</s:VGroup>
									<s:VGroup horizontalAlign="center" width="64">
										<s:Label text="Alcohol" styleName="subtitles" fontWeight="normal" />
										<s:Image source="{!model.hasMealBeenSubmitted ? model.alcoholEmpty : model.alcoholFull}" />
										<s:Label text="{!model.hasMealBeenSubmitted ? '0 drinks' : 'less than\n2 drinks'}" fontSize="11" color="0xCCCCCC" fontStyle="italic" textAlign="center" lineHeight="11" />
									</s:VGroup>
								</s:HGroup>-->
							</s:VGroup>
						</s:HGroup>
						
					</s:VGroup>
				</s:HGroup>	
				
				
				
				<!-- ******* -->
					<!--		<s:VGroup>
									
									<s:Label text="My Plate" styleName="greenBoldText" />
									
									<s:Label id="txtMyPlateSubtext" text="Today so far" color="0xBDBCBC" fontStyle="italic" fontSize="13" paddingTop="-2" paddingBottom="6" />
									
									<s:HGroup paddingTop="-25" paddingLeft="19">
										<s:Image id="imgNutJournalMyPlate" source="{!model.hasMealBeenSubmitted ? bigPlateEmpty : model.mealType == 'full' ? bigPlateFull : bigPlatePartial}" />
									</s:HGroup>
									
									<s:HGroup gap="19" paddingLeft="11" paddingTop="18">
										
										<s:VGroup horizontalAlign="center" width="64">
											<s:Label text="Sodium" styleName="greenBoldText" />
											<s:VGroup height="43">
												<s:Image id="imgNutJournalSodium" source="{!model.hasMealBeenSubmitted ? bigSodiumEmpty : model.mealType == 'full' ? bigSodiumFullRed : bigSodiumPartial}" />
											</s:VGroup>
											<s:Label id="lblNutJournalSodium" text="{!model.hasMealBeenSubmitted ? '0 mg.' : model.mealType == 'full' ? '2,000 mg.' : '600 mg.'}" fontSize="13" color="0xFFFFFF" />
										</s:VGroup>
										
										<s:VGroup horizontalAlign="center" width="64">
											<s:Label text="Fats &amp; Oils" styleName="greenBoldText" />
											<s:VGroup height="43">
												<s:Image id="imgNutJournalFatsOils" source="{!model.hasMealBeenSubmitted ? bigFatsOilsEmpty : model.mealType == 'full' ? bigFatsOilsFull : bigFatsOilsPartial}" />
											</s:VGroup>
											<s:Label id="lblNutJournalFatsOils" text="{!model.hasMealBeenSubmitted ? '0 servings' : model.mealType == 'full' ? '2 - 3\nservings' : '1 serving'}" fontSize="13" color="0xFFFFFF" textAlign="center" />
										</s:VGroup>
										
										<s:VGroup horizontalAlign="center" width="64">
											<s:Label text="Sugars" styleName="greenBoldText" />
											<s:VGroup height="43">
												<s:Image id="imgNutJournalSugars" source="{!model.hasMealBeenSubmitted ? model.sugarsEmpty : model.mealType == 'full' ? model.sugarsFull : model.sugarsPartial}" />
											</s:VGroup>
											<s:Label id="lblNutJournalSugars" text="{!model.hasMealBeenSubmitted ? '0 servings' : model.mealType == 'full' ? '2 - 3\nservings' : '1 serving'}" fontSize="13" color="0xFFFFFF" textAlign="center" />
										</s:VGroup>
										
										<s:VGroup horizontalAlign="center" width="64">
											<s:Label text="Alcohol" styleName="greenBoldText" />
											<s:VGroup height="43">
												<s:Image id="imgNutJournalAlcohol" source="{!model.hasMealBeenSubmitted ? bigAlcoholEmpty : model.mealType == 'full' ? bigAlcoholFull : bigAlcoholPartial}" />
											</s:VGroup>
											<s:Label id="lblNutJournalAlcohol" text="{!model.hasMealBeenSubmitted ? '0 drinks' : model.mealType == 'full' ? 'more than\n3 drinks' : 'less than\n2 drinks'}" fontSize="13" color="0xFFFFFF" textAlign="center" />
										</s:VGroup>
										
										<s:VGroup horizontalAlign="center" width="64">
											<s:Label text="Water" styleName="lightBlueSubtitles" />
											<s:VGroup height="43">
												<s:Image id="imgNutJournalWater" source="{glassesTaken == 0 ? bigWaterEmpty : glassesTaken == 8 ? bigWaterVeryFull : glassesTaken > 4 ? bigWaterFull : bigWaterPartial}" />
											</s:VGroup>
											<s:Label id="lblNutJournalWater" text="{glassesTaken + ' cups'}" fontSize="13" color="0xFFFFFF" />
										</s:VGroup>
										
									</s:HGroup>
									
								</s:VGroup>
							-->

			</s:NavigatorContent>
			
			<s:NavigatorContent label="My Food Plan">
				
				<s:layout>
					<s:VerticalLayout gap="0" />
				</s:layout>
				
				<s:BorderContainer height="40" width="100%" backgroundColor="0x706F6F">
					<s:layout>
						<s:HorizontalLayout verticalAlign="middle" paddingRight="6" paddingLeft="8"/>
					</s:layout>
					<s:Button label="Print My Food Plan" styleName="buttonText" height="24" />
				</s:BorderContainer>
				
				<s:Line xFrom="0" xTo="974">
					<s:stroke>
						<s:SolidColorStroke color="#3F3E3D"/>
					</s:stroke>
				</s:Line>
				
				<s:Scroller width="100%" height="563">
					
					<s:VGroup>
						
						<s:HGroup width="100%" horizontalAlign="right" verticalAlign="middle" gap="-1" paddingRight="10" paddingTop="5">
							<mx:LinkButton id="btnNutViewHistory" label="View History" paddingTop="-1" color="0xAEDEE4" textRollOverColor="0xAEDEE4" textSelectedColor="0xAEDEE4" skin="{null}" rollOver="{btnNutViewHistory.styleName='linkBtnUnderline';}" rollOut="btnNutViewHistory.styleName='linkBtn';" />
							<s:Image source="@Embed('/images/erBtnHelp.png')" buttonMode="true" />
						</s:HGroup>
						
						<s:VGroup width="805" paddingLeft="68">
							
							<s:Label text="My Food Plan" styleName="greenBoldText" />
							
							<s:HGroup verticalAlign="middle">
								<s:Label width="105" textAlign="right" text="Starting Date:" fontSize="11" fontWeight="bold" color="0x999999" />
								<s:Label text="August 25, 2011" color="0xEDEDED" />
							</s:HGroup>
							
							<s:HGroup verticalAlign="middle">
								<s:Label width="105" textAlign="right" text="Assigned by:" fontSize="11" fontWeight="bold" color="0x999999" />
								<s:Label text="Dr. Berg (Primary Physician) and Dr. Kirkpatrick (Dietitian)" color="0xEDEDED" fontWeight="bold" />
							</s:HGroup>
							
							<s:HGroup verticalAlign="middle">
								<s:Label width="105" textAlign="right" text="Reasons for Plan:" fontSize="11" fontWeight="bold" color="0x999999" />
								<s:Label text="Maintain current weight and nutrition" color="0xEDEDED" />
							</s:HGroup>
							
							<s:HGroup verticalAlign="middle">
								<s:Label width="105" textAlign="right" text="Direction:" fontSize="11" fontWeight="bold" color="0x999999" />
								<s:Label text="Eat well balanced meals and do not exceed the daily calorie budget" color="0xEDEDED" />
							</s:HGroup>
							
							<s:HGroup verticalAlign="middle" paddingBottom="2">
								<s:Label width="105" textAlign="right" text="Daily Calorie Budget:" fontSize="11" fontWeight="bold" color="0x999999" />
								<s:Label text="2,000 calories" color="0xEDEDED" />
							</s:HGroup>
							
							<s:BorderContainer width="805" height="346" styleName="transparentBorderContainer">
								
								<s:layout>
									<s:VerticalLayout paddingTop="16" paddingLeft="19" gap="7" />
								</s:layout>
								
								<s:HGroup>
									<s:Label text="My Daily Food Plan" styleName="greenBoldText" />
									<s:HGroup gap="3" paddingLeft="3">
										<s:Label fontSize="13" color="0xFFFFFF" fontStyle="italic" text="Hover food group icons to learn about" />
										<s:Label fontSize="13" color="0xFBB03B" fontStyle="italic" text="food examples" />
										<s:Label fontSize="13" color="0xFFFFFF" fontStyle="italic" text="and" />
										<s:Label fontSize="13" color="0xFBB03B" fontStyle="italic" text="serving sizes" />
									</s:HGroup>
								</s:HGroup>
								
								<s:BorderContainer borderVisible="false" backgroundAlpha="0">
									
									<s:layout>
										<s:BasicLayout />
									</s:layout>
									
									<s:Image source="@Embed('/images/nutritionMyFoodPlan.jpg')" x="32" y="9" />
									
									<s:BorderContainer width="90" height="98" borderVisible="false" backgroundAlpha="0" x="221" y="56" toolTip=" " toolTipCreate="createCustomTip('','', event)" buttonMode="true" />
									
									<s:BorderContainer width="111" height="32" borderVisible="false" backgroundAlpha="0" x="289" y="37" toolTip=" " toolTipCreate="createCustomTip('','', event)" buttonMode="true" />
								</s:BorderContainer>
								
								<!--<s:HGroup paddingLeft="32" paddingTop="9">
								<s:Image source="@Embed('/images/nutritionMyFoodPlan.jpg')" />
								</s:HGroup>-->
							</s:BorderContainer>
							
							<s:VGroup paddingTop="4" paddingBottom="4">
								
								<s:BorderContainer width="805" height="111" styleName="transparentBorderContainer">
									
									<s:layout>
										<s:HorizontalLayout paddingLeft="17" paddingTop="14" gap="28" />
									</s:layout>
									
									<s:VGroup>
										
										<s:HGroup width="100%" verticalAlign="middle" paddingBottom="-1">
											<s:Image source="@Embed('/images/iconGreenCircle.png')" />
											<s:Label text="Food to Increase" styleName="greenBoldText" />
											<s:Spacer width="100%" />
											<mx:LinkButton id="btnNutViewMore3" label="View More »" color="0xAEDEE4" textRollOverColor="0xAEDEE4" textSelectedColor="0xAEDEE4" skin="{null}" rollOver="{btnNutViewMore3.styleName='linkBtnUnderline';}" rollOut="btnNutViewMore3.styleName='linkBtn';" click="setState(Constants.MODULE_EDUCATIONAL_RESOURCES);" />
										</s:HGroup>
										
										<s:HGroup gap="2">
											<s:Image source="assets/images/nutrition/foods/bread.jpg" toolTip="Whole wheat bread" />
											<s:Image source="assets/images/nutrition/foods/berries.jpg" toolTip="Berries" />
											<s:Image source="assets/images/nutrition/foods/vegetables.jpg" toolTip="Vegetables" />
											<s:Image source="assets/images/nutrition/foods/grapes.jpg" toolTip="Grapes" />
											<s:Image source="assets/images/nutrition/foods/lettuce.jpg" toolTip="Lettuce" />
											<s:Image source="assets/images/nutrition/foods/water.jpg" toolTip="Water" />
										</s:HGroup>
										
									</s:VGroup>
									
									<s:Line yFrom="0" yTo="79">
										<s:stroke>
											<s:SolidColorStroke color="#BDBCBC"/>
										</s:stroke>
									</s:Line>
									
									<s:VGroup>
										
										<s:HGroup width="100%" verticalAlign="middle" paddingBottom="-1">
											<s:Image source="@Embed('/images/iconRedCross.png')" />
											<s:Label text="Food to Limit" styleName="greenBoldText" />
											<s:Spacer width="100%" />
											<mx:LinkButton id="btnNutViewMore4" label="View More »" color="0xAEDEE4" textRollOverColor="0xAEDEE4" textSelectedColor="0xAEDEE4" skin="{null}" rollOver="{btnNutViewMore4.styleName='linkBtnUnderline';}" rollOut="btnNutViewMore4.styleName='linkBtn';" click="setState(Constants.MODULE_EDUCATIONAL_RESOURCES);" />
										</s:HGroup>
										
										<s:HGroup gap="2">
											<s:Image source="assets//images/nutrition/foods/cheese.jpg" toolTip="Cheese" />
											<s:Image source="assets/images/nutrition/foods/redmeat.jpg" toolTip="Red meat" />
											<s:Image source="assets/images/nutrition/foods/icecream.jpg" toolTip="Ice cream" />
											<s:Image source="assets/images/nutrition/foods/friedchicken.jpg" toolTip="Fried chicken" />
											<s:Image source="assets/images/nutrition/foods/hamburgers.jpg" toolTip="Hamburgers" />
											<s:Image source="assets/images/nutrition/foods/soda.jpg" toolTip="Soda" />
										</s:HGroup>
										
									</s:VGroup>
									
								</s:BorderContainer>
								
							</s:VGroup>
							
							<s:HGroup paddingBottom="10" gap="26">
								
								<s:BorderContainer width="454" maxHeight="242" backgroundColor="0x3C3C3B" borderColor="0xBDBDBC" cornerRadius="3">
									
									<s:layout>
										<s:VerticalLayout paddingTop="17" />
									</s:layout>
									
									<s:HGroup width="100%" paddingRight="7" paddingTop="-1" paddingLeft="23" paddingBottom="6">
										<s:Label text="Notes from My Doctors" styleName="greenBoldText" paddingTop="1" />
										<s:Spacer width="100%" />
										<mx:LinkButton id="btnNotesHistory" label="History" fontSize="11" paddingTop="-6" color="0xAEDEE4" textRollOverColor="0xAEDEE4" textSelectedColor="0xAEDEE4" skin="{null}" rollOver="{btnNotesHistory.styleName='linkBtnUnderline';}" rollOut="btnNotesHistory.styleName='linkBtn';" />
									</s:HGroup>
									
									<s:Label text="Dr. Berg" color="0xFFFFFF" fontWeight="bold" fontSize="11" paddingLeft="23" />
									
									<mx:DataGrid id="dgNutritionNotes" dataProvider="{model.notes}" width="100%" height="100%" fontSize="12" color="0xEDEDED" selectable="false" headerHeight="0" borderVisible="false" rowHeight="64" verticalGridLines="false" horizontalGridLines="false" alternatingItemColors="[0x303030,0x3C3C3B]">
										<mx:columns>
											<mx:DataGridColumn dataField="note" paddingLeft="23" width="325">
												<mx:itemRenderer>
													<fx:Component>		
														<mx:HBox paddingTop="8">
															<s:Label text="•" fontSize="6" paddingTop="2" />
															<mx:VBox verticalGap="3"><!--no vgap when fontFamily="myMyriadNoCFF"-->
																<s:Label text="{data.note}" width="274" lineHeight="16" />
																<mx:HBox visible="{data.recommendation != ''}" includeInLayout="{data.recommendation != ''}">
																	<s:Label text="Recommendation:" paddingTop="4" /><!--paddingTop was 2 when fontFamily="myMyriadNoCFF"-->
																	<mx:LinkButton id="btnNextStepsRecommendation" label="{data.recommendation}" paddingTop="-5" paddingLeft="-7" color="0xAEDEE4" textRollOverColor="0xAEDEE4" textSelectedColor="0xAEDEE4" skin="{null}" rollOver="{btnNextStepsRecommendation.styleName='linkBtnUnderline';}" rollOut="btnNextStepsRecommendation.styleName='linkBtn';" /><!--click="{outerDocument.handleRecommendation(data.recommendation)}" //COMMENTED OUT BECAUSE IT'S THROWING AN ERROR THAT DOESN'T MAKE ANY SENSE (about closing the popup, error doesn't appear on Chrome)-->
																</mx:HBox>
															</mx:VBox>
														</mx:HBox>
													</fx:Component>
												</mx:itemRenderer>
											</mx:DataGridColumn>
											<mx:DataGridColumn dataField="completed">
												<mx:itemRenderer>
													<fx:Component>		
														<mx:HBox paddingTop="13" horizontalGap="-2" horizontalScrollPolicy="off" verticalScrollPolicy="off">
															<mx:VBox paddingTop="2">
																<s:Image source="@Embed('/images/checkmarkNextSteps.png')" toolTip="Completed" visible="{data.completed}" />
															</mx:VBox>
															<mx:VBox verticalGap="1" paddingTop="-2"><!--vgap was 3, no paddingTop-->
																<mx:LinkButton id="btnNextStepsMarkCompleted" label="{data.completed ? 'Unmark completed' : 'Mark completed'}" paddingTop="-5" color="0xAEDEE4" click="{data.completed = !data.completed; outerDocument.model.notes.refresh();}" textRollOverColor="0xAEDEE4" textSelectedColor="0xAEDEE4" skin="{null}" rollOver="{btnNextStepsMarkCompleted.styleName='linkBtnUnderline';}" rollOut="btnNextStepsMarkCompleted.styleName='linkBtn';" />
																<mx:LinkButton id="btnNextStepsDelete" label="Remove" color="0xAEDEE4" textRollOverColor="0xAEDEE4" click="{outerDocument.model.notes.removeItemAt(outerDocument.model.notes.getItemIndex(data))}" textSelectedColor="0xAEDEE4" skin="{null}" rollOver="{btnNextStepsDelete.styleName='linkBtnUnderline';}" rollOut="btnNextStepsDelete.styleName='linkBtn';" />
															</mx:VBox>
														</mx:HBox>
													</fx:Component>
												</mx:itemRenderer>
											</mx:DataGridColumn>
										</mx:columns>
									</mx:DataGrid>
								</s:BorderContainer>
								
								<s:BorderContainer width="325" maxHeight="255" backgroundColor="0x3C3C3B" borderColor="0xBDBDBC" cornerRadius="3">
									
									<s:layout>
										<s:VerticalLayout paddingTop="17" />
									</s:layout>
									
									<s:Label text="Suggested Meals for a Day" styleName="greenBoldText" paddingLeft="23" />
									
									<s:Label text="Breakfast" color="0xFFFFFF" fontWeight="bold" fontSize="13" paddingLeft="23" paddingTop="8" />
									
									<mx:DataGrid dataProvider="{model.meals}" fontFamily="myMyriadNoCFF" verticalScrollPolicy="off" width="100%" height="100%" fontSize="13" color="0xFFFFFF" selectable="false" headerHeight="0" borderVisible="false" rowHeight="64" verticalGridLines="false" horizontalGridLines="false" alternatingItemColors="[0x303030,0x3C3C3B]">
										<mx:columns>
											<mx:DataGridColumn dataField="meal" paddingLeft="23" />
										</mx:columns>
									</mx:DataGrid>
									
								</s:BorderContainer>
							</s:HGroup>
						</s:VGroup>
						
					</s:VGroup>
					
				</s:Scroller>
			</s:NavigatorContent>
			
		</mx:ViewStack>
		
		<plus:TabBarPlus id="tabsNutrition" gap="6" cornerRadius="4" styleName="messagesTabs" closePolicy="never" dataProvider="{viewStackNutrition}" /><!--change="tabsMedicalRecordsChangeHandler(event)"-->
	
	</s:Group>
	
</s:VGroup>
